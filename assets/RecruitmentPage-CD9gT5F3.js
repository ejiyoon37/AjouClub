import{u as B,b as O,r as c,a as R,j as t}from"./index-DEXBsR4C.js";import{H as k}from"./Header-iK4IU58C.js";import{T as y,S as L,F as M,B as P,a as T}from"./icn_filter_16-sHNFjkWQ.js";import{u as E,R as H}from"./Card_recruitment-DzUhBrei.js";import{u as $}from"./useMypageData-FRZiUGxZ.js";import{S as G}from"./ic-arrow-down-gray-24-BaSmCaq3.js";import"./icn_search_24-2-dtgI0gZA.js";import"./useQuery-C7pHblR0.js";import"./Chip_period-CU_w5nP-.js";import"./recruitment-Lb3dTcqX.js";import"./Default_images-DTygkBZ9.js";const ee=()=>{const g=B(),v=O(),{posts:d,isLoading:N,error:p}=E(),[C,m]=c.useState(!1),[o,I]=c.useState("최근 게시순"),u=R(e=>e.isLoggedIn),{favorites:x,isLoading:w}=$(),[a,A]=c.useState(v.state?.filters||{categories:[],types:[],statuses:[],department:""}),D=["최근 게시순","저장순","마감 임박순"],F=e=>{I(e),m(!1)},h=[...a.categories,...a.types,...a.statuses,...a.department&&a.department!=="전체"?[a.department]:[]],l=h.length,b=e=>{A(s=>({categories:s.categories.filter(i=>i!==e),types:s.types.filter(i=>i!==e),statuses:s.statuses.filter(i=>i!==e),department:s.department===e?"":s.department}))},j=c.useMemo(()=>{if(!u||!x)return d;const e=new Set(x.map(s=>s.recruitmentId));return d.map(s=>({...s,isScrapped:e.has(s.recruitmentId)}))},[d,x,u]),S=c.useMemo(()=>{const s=[...j.filter(r=>!(a.statuses.length>0&&!a.statuses.some(f=>f==="모집중"?r.status==="d-day":f==="모집 마감"?r.status==="end":f==="상시 모집"?r.status==="regular":!1)))],i=r=>r.status==="end"?1/0:r.status==="regular"?1e3:r.dDay;switch(o){case"최근 게시순":return s.sort((r,n)=>new Date(n.createdAt).getTime()-new Date(r.createdAt).getTime());case"저장순":return s.sort((r,n)=>n.scrapCount-r.scrapCount);case"마감 임박순":return s.sort((r,n)=>i(r)-i(n));default:return s}},[j,o,a]);return N||u&&w?t.jsx("div",{className:"p-4 text-center",children:"로딩 중..."}):p?t.jsxs("div",{className:"p-4 text-center text-red-500",children:["오류 발생: ",p.message]}):t.jsxs("div",{className:"flex flex-col min-h-screen bg-white",children:[t.jsx(k,{variant:"page"}),t.jsxs("nav",{className:"flex gap-3 px-4 pt-2",children:[t.jsx(y,{isActive:!0,children:"모집공고"}),t.jsx(y,{isActive:!1,onClick:()=>g("/clubs"),children:"동아리 둘러보기"})]}),t.jsxs("div",{className:"flex justify-between items-center p-4",children:[t.jsxs("button",{className:"flex items-center gap-1",onClick:()=>m(!0),children:[t.jsx("span",{className:"text-sm text-gray-700 font-medium",children:o}),t.jsx(G,{className:"w-4 h-4 -rotate-90 text-gray-700"})]}),t.jsxs("button",{className:"flex items-center gap-1",onClick:()=>g("/recruitment/filter",{state:{filters:a}}),children:[t.jsx(L,{className:"w-4 h-4"}),t.jsxs("span",{className:`text-sm font-medium ${l>0?"text-gray-700":"text-gray-300"}`,children:["필터 ",l>0&&`(${l})`]})]})]}),l>0&&t.jsx("div",{className:"flex gap-2 px-4 pb-3 overflow-x-auto scrollbar-hide border-b border-gray-100",children:h.map(e=>t.jsx(M,{onDelete:()=>b(e),children:e},e))}),t.jsx("main",{className:"flex-grow px-4 pt-4",children:S.length>0?t.jsx("div",{className:"grid grid-cols-3 gap-3",children:S.map(e=>t.jsx(H,{recruitmentId:e.recruitmentId,clubId:e.clubId,images:e.images,title:e.title,status:e.status,dDay:e.dDay,viewCount:e.viewCount,scrapCount:e.scrapCount,isScrappedInitially:e.isScrapped},e.recruitmentId))}):t.jsx("div",{className:"flex flex-col items-center justify-center pt-20",children:t.jsx("p",{className:"text-[16px] font-semibold text-gray-500 leading-[1.35] tracking-[-0.03em] text-center",children:"해당하는 모집 공고가 없습니다."})})}),t.jsx(P,{isOpen:C,onClose:()=>m(!1),children:t.jsx("ul",{className:"space-y-2",children:D.map(e=>t.jsx("li",{children:t.jsx(T,{isActive:o===e,onClick:()=>F(e),children:e})},e))})})]})};export{ee as default};
